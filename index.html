<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="StudyMate Light - Smart Study Dashboard (KHKT Project)">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>StudyMate Light – Hệ thống đèn học thông minh</title>
  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tailwind config: neutral palette, accent emerald
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              50: '#ecfdf5', 100: '#d1fae5', 200: '#a7f3d0', 300: '#6ee7b7',
              400: '#34d399', 500: '#10b981', 600: '#059669', 700: '#047857',
              800: '#065f46', 900: '#064e3b'
            }
          }
        }
      }
    }
  </script>
  <!-- Icons -->
  <script src="https://unpkg.com/lucide@latest"></script>
  <!-- React 18 + Babel for JSX in one file -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- Recharts UMD -->
  <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>
  <style>
    html,body,#root{height:100%}
    /* Subtle glow for alerting cards */
    .glow { box-shadow: 0 0 0.75rem 0.25rem rgba(239,68,68,0.25); }
  </style>
</head>
<body class="bg-gray-50 text-gray-900">
  <div id="root"></div>

  <script type="text/babel">
    const { useEffect, useMemo, useRef, useState } = React;
    const {
      LineChart, Line, CartesianGrid, Tooltip, Legend, XAxis, YAxis, ResponsiveContainer
    } = Recharts;

    // ---------- Utilities ----------
    const nowISO = () => new Date().toISOString();

    function beep(duration = 120, type = 'sine', volume = 0.1) {
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const o = ctx.createOscillator();
        const g = ctx.createGain();
        o.type = type; o.frequency.value = 880; // A5
        g.gain.value = volume; o.connect(g); g.connect(ctx.destination);
        o.start(); setTimeout(() => { o.stop(); ctx.close(); }, duration);
      } catch { /* no-audio */ }
    }

    function formatTime(ms) {
      const s = Math.max(0, Math.floor(ms / 1000));
      const mm = String(Math.floor(s / 60)).padStart(2,'0');
      const ss = String(s % 60).padStart(2,'0');
      return `${mm}:${ss}`;
    }

    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

    function humanTime(ts) {
      const d = new Date(ts);
      return d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
    }

    // ---------- Storage Keys ----------
    const LS_KEYS = {
      HISTORY: 'sml_history_v1',
      THRESH: 'sml_thresholds_v1',
      POMO: 'sml_pomodoro_v1',
      LOGS: 'sml_logs_v1',
      UI: 'sml_ui_v1'
    };

    // ---------- App ----------
    function App(){
      // Mode & connection
      const [mode, setMode] = useState('demo');
      const [connected, setConnected] = useState(false);

      // Thresholds & settings
      const [thresholds, setThresholds] = useState(() => ({
        luxMin: 400, luxMax: 600,
        distMin: 35, distMax: 60,
        tempMin: 22, tempMax: 28,
        humMin: 40, humMax: 60,
        alarmEnabled: true, simSpeed: 1,
      }));

      // UI preferences
      const [ui, setUi] = useState(() => ({ showLux: true, showTemp: true, showHum: true, showDist: true }));

      // Live sample
      const [sample, setSample] = useState(() => ({
        timestamp: Date.now(), lux: 520, temp: 26, hum: 55, dist: 45, led: 50
      }));

      // History (downsampled) & Logs
      const [history, setHistory] = useState(() => {
        try { return JSON.parse(localStorage.getItem(LS_KEYS.HISTORY)) || []; } catch { return []; }
      });
      const [logs, setLogs] = useState(() => {
        try { return JSON.parse(localStorage.getItem(LS_KEYS.LOGS)) || []; } catch { return []; }
      });

      // Pomodoro
      const [pomo, setPomo] = useState(() => {
        const def = { work: 25, rest: 5, phase: 'idle', remainingSec: 25*60, running: false };
        try { return { ...def, ...(JSON.parse(localStorage.getItem(LS_KEYS.POMO))||{}) }; } catch { return def; }
      });

      // Persist settings
      useEffect(() => { localStorage.setItem(LS_KEYS.THRESH, JSON.stringify(thresholds)); }, [thresholds]);
      useEffect(() => { localStorage.setItem(LS_KEYS.HISTORY, JSON.stringify(history)); }, [history]);
      useEffect(() => { localStorage.setItem(LS_KEYS.POMO, JSON.stringify(pomo)); }, [pomo]);
      useEffect(() => { localStorage.setItem(LS_KEYS.LOGS, JSON.stringify(logs)); }, [logs]);
      useEffect(() => { localStorage.setItem(LS_KEYS.UI, JSON.stringify(ui)); }, [ui]);
      
      // Restore thresholds/ui if present
      useEffect(() => {
        try { const t = JSON.parse(localStorage.getItem(LS_KEYS.THRESH)); if (t) setThresholds(t); } catch {}
        try { const u = JSON.parse(localStorage.getItem(LS_KEYS.UI)); if (u) setUi(u); } catch {}
      }, []);

      // --- Demo data synth ---
      const simSeed = useRef({ lux: 520, temp: 26, hum: 55, dist: 45, led: 50, t: 0 });
      const tickRef = useRef(null);
      const lastCaptureRef = useRef(0);

      function pushLog(type, message){
        const item = { id: crypto.randomUUID(), time: nowISO(), type, message };
        setLogs(prev => (prev.concat(item)).slice(-200));
      }

      // Notification helper (why: external judges may switch tab)
      function notify(title, body){
        try {
          if (Notification.permission === 'granted') new Notification(title, { body });
          else if (Notification.permission !== 'denied') Notification.requestPermission();
        } catch {}
      }

      function computeLed(lux, {luxMin, luxMax}){
        let led = sample.led;
        if (lux < luxMin) led += 8;
        else if (lux > luxMax) led -= 8;
        return clamp(Math.round(led), 0, 100);
      }

      function statusFlags(s, th){
        const postureBad = (s.dist < th.distMin || s.dist > th.distMax);
        const tempBad = (s.temp < th.tempMin || s.temp > th.tempMax);
        const humBad = (s.hum < th.humMin || s.hum > th.humMax);
        const lightLow = s.lux < th.luxMin; const lightHigh = s.lux > th.luxMax;
        return { postureBad, tempBad, humBad, lightLow, lightHigh };
      }

      // Main interval
      useEffect(() => {
        const baseMs = 1000;
        if (tickRef.current) clearInterval(tickRef.current);
        tickRef.current = setInterval(() => {
          setSample(prev => {
            let next = { ...prev };
            if (mode === 'demo'){
              // Smooth day-night illumination curve + noise
              simSeed.current.t += thresholds.simSpeed * 0.02;
              const day = 500 + 150 * Math.sin(simSeed.current.t);
              const rnd = (n) => (Math.random()*n - n/2);
              next.lux = clamp(Math.round(day + rnd(60)), 100, 900);
              next.temp = clamp(Math.round(26 + Math.sin(simSeed.current.t/3)*2 + rnd(0.8)), 18, 34);
              next.hum = clamp(Math.round(50 + Math.cos(simSeed.current.t/2)*8 + rnd(5)), 20, 90);
              next.dist = clamp(Math.round(45 + Math.sin(simSeed.current.t*2)*6 + rnd(4)), 20, 90);
            }
            // LED auto-control by lux
            next.led = computeLed(next.lux, thresholds);
            next.timestamp = Date.now();

            const flags = statusFlags(next, thresholds);
            if (thresholds.alarmEnabled){
              if (flags.postureBad) { beep(); pushLog('Tư thế', `Khoảng cách ${next.dist}cm ngoài chuẩn`); }
              if (flags.tempBad) { beep(90, 'triangle'); pushLog('Nhiệt độ', `${next.temp}°C ngoài ngưỡng`); }
              if (flags.humBad) { beep(90, 'triangle'); pushLog('Độ ẩm', `${next.hum}% ngoài ngưỡng`); }
            }

            // Capture history each 2s
            if (Date.now() - lastCaptureRef.current > 2000){
              lastCaptureRef.current = Date.now();
              setHistory(h => (h.concat({
                t: next.timestamp, lux: next.lux, temp: next.temp, hum: next.hum, dist: next.dist, led: next.led
              })).filter(x => next.timestamp - x.t <= 30*60*1000)); // 30min window
            }
            return next;
          });

          // Pomodoro tick
          setPomo(p => {
            if (!p.running || p.phase==='idle') return p;
            const remaining = p.remainingSec - 1;
            if (remaining > 0) return { ...p, remainingSec: remaining };
            // switch phase
            const nextPhase = p.phase === 'work' ? 'rest' : 'work';
            const nextDur = (nextPhase === 'work' ? p.work : p.rest) * 60;
            notify('Pomodoro', nextPhase==='rest' ? 'Đến giờ nghỉ!' : 'Quay lại học nhé!');
            beep(250, 'square', 0.15);
            return { ...p, phase: nextPhase, remainingSec: nextDur };
          });
        }, Math.max(200, baseMs / Math.max(1, thresholds.simSpeed)));
        return () => clearInterval(tickRef.current);
      }, [mode, thresholds.simSpeed]);

      // Pomodoro controls
      function startPomodoro(){
        setPomo(p => {
          if (p.phase==='idle') return { ...p, phase: 'work', remainingSec: p.work*60, running: true };
          return { ...p, running: true };
        });
      }
      function pausePomodoro(){ setPomo(p => ({ ...p, running: false })); }
      function resetPomodoro(){ setPomo(p => ({ ...p, phase: 'idle', remainingSec: p.work*60, running: false })); }

      // Live connectors (stubs)
      async function connectSerial(){
        // why: to show judges readiness for ESP32/Arduino via Web Serial
        pushLog('Kết nối', 'Serial (stub) sẵn sàng tích hợp firmware JSON');
        setConnected(true);
      }
      async function connectBLE(){
        pushLog('Kết nối', 'Bluetooth (stub) sẵn sàng tích hợp firmware JSON');
        setConnected(true);
      }

      const flags = useMemo(() => statusFlags(sample, thresholds), [sample, thresholds]);
      const anyAlert = flags.postureBad || flags.tempBad || flags.humBad || flags.lightLow || flags.lightHigh;

      return (
        <div className="min-h-full flex flex-col">
          <Header mode={mode} setMode={setMode} connected={connected} onSerial={connectSerial} onBLE={connectBLE} />

          <main className="container mx-auto max-w-7xl px-4 py-6 space-y-6">
            <Hero anyAlert={anyAlert} />

            <Kpis sample={sample} flags={flags} thresholds={thresholds} />

            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <PomodoroCard pomo={pomo} setPomo={setPomo} onStart={startPomodoro} onPause={pausePomodoro} onReset={resetPomodoro} />
              <SettingsCard thresholds={thresholds} setThresholds={setThresholds} ui={ui} setUi={setUi} />
              <LogCard logs={logs} onClear={() => setLogs([])} />
            </div>

            <ChartCard history={history} ui={ui} />
          </main>

          <Footer />
        </div>
      );
    }

    // ---------- Components ----------
    function Header({ mode, setMode, connected, onSerial, onBLE }){
      useEffect(() => { lucide.createIcons(); });
      return (
        <header className="border-b bg-white/70 backdrop-blur">
          <div className="container mx-auto max-w-7xl px-4 py-3 flex items-center justify-between">
            <div className="flex items-center gap-3">
              <span className="inline-flex items-center justify-center w-10 h-10 rounded-2xl bg-brand-100 text-brand-700">
                <i data-lucide="lamp" className="w-6 h-6"></i>
              </span>
              <div>
                <h1 className="text-lg font-semibold">StudyMate Light</h1>
                <p className="text-xs text-gray-500">Đèn học thông minh · Tư thế · Môi trường · Pomodoro</p>
              </div>
            </div>
            <div className="flex items-center gap-3">
              <ModeSwitch mode={mode} setMode={setMode} />
              <button onClick={onSerial} className="px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm">
                <i data-lucide="cable" className="w-4 h-4 inline-block mr-1"></i> Serial
              </button>
              <button onClick={onBLE} className="px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm">
                <i data-lucide="bluetooth" className="w-4 h-4 inline-block mr-1"></i> BLE
              </button>
              <span className={`px-2 py-1 rounded-lg text-xs ${connected? 'bg-green-100 text-green-700':'bg-gray-100 text-gray-500'}`}>{connected? 'Đã sẵn sàng' : 'Chưa kết nối'}</span>
            </div>
          </div>
        </header>
      );
    }

    function ModeSwitch({ mode, setMode }){
      return (
        <div className="flex items-center gap-2 text-sm">
          <span className={mode==='demo'? 'font-semibold text-brand-700':''}>Demo</span>
          <label className="inline-flex items-center cursor-pointer">
            <input type="checkbox" className="sr-only peer" checked={mode==='live'} onChange={e => setMode(e.target.checked? 'live':'demo')} />
            <div className="w-12 h-6 bg-gray-200 peer-checked:bg-brand-500 rounded-full relative transition">
              <div className="absolute top-1 left-1 w-4 h-4 bg-white rounded-full shadow transition peer-checked:translate-x-6"></div>
            </div>
          </label>
          <span className={mode==='live'? 'font-semibold text-brand-700':''}>Live</span>
        </div>
      );
    }

    function Hero({ anyAlert }){
      return (
        <section className={`rounded-2xl border p-4 sm:p-5 bg-white ${anyAlert? 'glow':''}`}>
          <div className="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3">
            <div className="space-y-1">
              <h2 className="text-xl font-semibold">Bảng điều khiển thời gian thực</h2>
              <p className="text-sm text-gray-600">Tự động điều chỉnh ánh sáng (400–600 lux), cảnh báo tư thế, giám sát nhiệt độ/độ ẩm và hẹn giờ Pomodoro.</p>
            </div>
            <div className="text-xs text-gray-500">Trạng thái: {anyAlert? <span className="text-red-600 font-medium">Cần chú ý</span> : <span className="text-green-600 font-medium">Ổn định</span>}</div>
          </div>
        </section>
      );
    }

    function Pill({ ok, label, badText }){
      return (
        <div className={`px-2 py-1 rounded-lg text-xs font-medium ${ok? 'bg-green-100 text-green-700':'bg-red-100 text-red-700'}`}>{ok? label : badText}</div>
      );
    }

    function Kpis({ sample, flags, thresholds }){
      const cards = [
        { key:'lux', title:'Độ sáng (lux)', value: sample.lux, ok: !flags.lightLow && !flags.lightHigh, unit:'lx', range:`${thresholds.luxMin}–${thresholds.luxMax}` },
        { key:'led', title:'Mức sáng đèn', value: sample.led, ok: true, unit:'%', range:'Auto' },
        { key:'temp', title:'Nhiệt độ', value: sample.temp, ok: !flags.tempBad, unit:'°C', range:`${thresholds.tempMin}–${thresholds.tempMax}` },
        { key:'hum', title:'Độ ẩm', value: sample.hum, ok: !flags.humBad, unit:'%', range:`${thresholds.humMin}–${thresholds.humMax}` },
        { key:'dist', title:'Khoảng cách', value: sample.dist, ok: !flags.postureBad, unit:'cm', range:`${thresholds.distMin}–${thresholds.distMax}` },
      ];
      return (
        <section className="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-5 gap-4">
          {cards.map(c => (
            <div key={c.key} className={`rounded-2xl border bg-white p-4 ${!c.ok? 'border-red-300': ''}`}>
              <div className="flex items-start justify-between">
                <div>
                  <div className="text-sm text-gray-600">{c.title}</div>
                  <div className="text-2xl font-semibold mt-1">{c.value}<span className="text-base font-medium text-gray-500 ml-1">{c.unit}</span></div>
                </div>
                <Pill ok={c.ok} label="OK" badText="Cảnh báo" />
              </div>
              <div className="mt-3 text-xs text-gray-500">Chuẩn: {c.range}</div>
            </div>
          ))}
        </section>
      );
    }

    function PomodoroCard({ pomo, setPomo, onStart, onPause, onReset }){
      const total = (pomo.phase==='work'? pomo.work : pomo.rest) * 60 || (pomo.work*60);
      const pct = clamp(100 * (pomo.remainingSec) / Math.max(1, total), 0, 100);
      return (
        <section className="rounded-2xl border bg-white p-4">
          <div className="flex items-center justify-between mb-3">
            <h3 className="font-semibold">Pomodoro</h3>
            <div className="text-xs text-gray-500">Pha: <span className="font-medium">{pomo.phase}</span></div>
          </div>
          <div className="w-full h-3 bg-gray-100 rounded-full overflow-hidden">
            <div className="h-3 bg-brand-500" style={{width: pct+'%'}}></div>
          </div>
          <div className="mt-3 text-3xl font-semibold tabular-nums">{formatTime(pomo.remainingSec*1000)}</div>
          <div className="mt-4 flex items-center gap-2">
            <button onClick={onStart} className="px-3 py-2 rounded-xl bg-brand-600 text-white hover:bg-brand-700 text-sm">Bắt đầu</button>
            <button onClick={onPause} className="px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm">Tạm dừng</button>
            <button onClick={onReset} className="px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm">Đặt lại</button>
          </div>
          <div className="mt-4 grid grid-cols-2 gap-3 text-sm">
            <label className="flex items-center gap-2">Học (phút)
              <input type="number" min="1" value={pomo.work} onChange={e => setPomo(p => ({...p, work: Number(e.target.value), remainingSec: Number(e.target.value)*60 }))} className="ml-auto w-20 px-2 py-1 rounded-lg border" />
            </label>
            <label className="flex items-center gap-2">Nghỉ (phút)
              <input type="number" min="1" value={pomo.rest} onChange={e => setPomo(p => ({...p, rest: Number(e.target.value)}))} className="ml-auto w-20 px-2 py-1 rounded-lg border" />
            </label>
          </div>
        </section>
      );
    }

    function SettingsCard({ thresholds, setThresholds, ui, setUi }){
      return (
        <section className="rounded-2xl border bg-white p-4">
          <h3 className="font-semibold mb-3">Cài đặt</h3>
          <div className="grid grid-cols-2 gap-3 text-sm">
            <Num label="Lux min" val={thresholds.luxMin} onChange={v=>setThresholds(t=>({...t, luxMin:v}))} />
            <Num label="Lux max" val={thresholds.luxMax} onChange={v=>setThresholds(t=>({...t, luxMax:v}))} />
            <Num label="Khoảng cách min (cm)" val={thresholds.distMin} onChange={v=>setThresholds(t=>({...t, distMin:v}))} />
            <Num label="Khoảng cách max (cm)" val={thresholds.distMax} onChange={v=>setThresholds(t=>({...t, distMax:v}))} />
            <Num label="Nhiệt độ min (°C)" val={thresholds.tempMin} onChange={v=>setThresholds(t=>({...t, tempMin:v}))} />
            <Num label="Nhiệt độ max (°C)" val={thresholds.tempMax} onChange={v=>setThresholds(t=>({...t, tempMax:v}))} />
            <Num label="Độ ẩm min (%)" val={thresholds.humMin} onChange={v=>setThresholds(t=>({...t, humMin:v}))} />
            <Num label="Độ ẩm max (%)" val={thresholds.humMax} onChange={v=>setThresholds(t=>({...t, humMax:v}))} />
            <Num label="Tốc độ mô phỏng" min={1} max={5} val={thresholds.simSpeed} onChange={v=>setThresholds(t=>({...t, simSpeed:v}))} />
          </div>
          <div className="mt-3 flex flex-wrap items-center gap-3 text-sm">
            <label className="inline-flex items-center gap-2">
              <input type="checkbox" checked={thresholds.alarmEnabled} onChange={e=>setThresholds(t=>({...t, alarmEnabled:e.target.checked}))} /> Báo âm thanh
            </label>
            <div className="ml-auto flex items-center gap-2 text-xs">
              <label className="inline-flex items-center gap-2">
                <input type="checkbox" checked={ui.showLux} onChange={e=>setUi(u=>({...u, showLux:e.target.checked}))} /> Lux
              </label>
              <label className="inline-flex items-center gap-2">
                <input type="checkbox" checked={ui.showTemp} onChange={e=>setUi(u=>({...u, showTemp:e.target.checked}))} /> Temp
              </label>
              <label className="inline-flex items-center gap-2">
                <input type="checkbox" checked={ui.showHum} onChange={e=>setUi(u=>({...u, showHum:e.target.checked}))} /> Hum
              </label>
              <label className="inline-flex items-center gap-2">
                <input type="checkbox" checked={ui.showDist} onChange={e=>setUi(u=>({...u, showDist:e.target.checked}))} /> Dist
              </label>
            </div>
          </div>
          <div className="mt-4 flex items-center gap-2 text-sm">
            <button className="px-3 py-2 rounded-xl bg-gray-100 hover:bg-gray-200" onClick={()=>{ localStorage.clear(); location.reload(); }}>Xóa dữ liệu</button>
          </div>
        </section>
      );
    }

    function Num({ label, val, onChange, min=0, max=999 }){
      return (
        <label className="flex items-center gap-2">{label}
          <input type="number" min={min} max={max} value={val}
                 onChange={e=>onChange(Number(e.target.value))}
                 className="ml-auto w-24 px-2 py-1 rounded-lg border" />
        </label>
      );
    }

    function LogCard({ logs, onClear }){
      return (
        <section className="rounded-2xl border bg-white p-4">
          <div className="flex items-center justify-between mb-3">
            <h3 className="font-semibold">Nhật ký</h3>
            <button onClick={onClear} className="px-3 py-1.5 rounded-xl bg-gray-100 hover:bg-gray-200 text-sm">Xóa</button>
          </div>
          <div className="max-h-64 overflow-auto divide-y text-sm">
            {logs.length===0 && <div className="text-gray-500">Chưa có sự kiện.</div>}
            {logs.slice().reverse().map(item => (
              <div key={item.id} className="py-2 flex items-start gap-2">
                <span className="text-xs text-gray-500 w-24 shrink-0">{new Date(item.time).toLocaleTimeString()}</span>
                <span className="px-2 py-0.5 rounded bg-gray-100 text-gray-700 text-xs">{item.type}</span>
                <span className="text-gray-800">{item.message}</span>
              </div>
            ))}
          </div>
        </section>
      );
    }

    function ChartCard({ history, ui }){
      const data = history.map(h => ({
        time: new Date(h.t).toLocaleTimeString(), lux: h.lux, temp: h.temp, hum: h.hum, dist: h.dist
      }));
      return (
        <section className="rounded-2xl border bg-white p-4">
          <div className="flex items-center justify-between mb-3">
            <h3 className="font-semibold">Biểu đồ lịch sử (30 phút gần nhất)</h3>
            <span className="text-xs text-gray-500">{history.length} mẫu</span>
          </div>
          <div className="h-72">
            <ResponsiveContainer width="100%" height="100%">
              <LineChart data={data} margin={{ top: 5, right: 20, left: 10, bottom: 5 }}>
                <CartesianGrid stroke="#eee" strokeDasharray="4 4" />
                <XAxis dataKey="time" minTickGap={24} />
                <YAxis />
                <Tooltip />
                <Legend />
                {ui.showLux && <Line type="monotone" dataKey="lux" stroke="#10b981" dot={false} strokeWidth={2} />}
                {ui.showTemp && <Line type="monotone" dataKey="temp" stroke="#3b82f6" dot={false} strokeWidth={2} />}
                {ui.showHum && <Line type="monotone" dataKey="hum" stroke="#f59e0b" dot={false} strokeWidth={2} />}
                {ui.showDist && <Line type="monotone" dataKey="dist" stroke="#ef4444" dot={false} strokeWidth={2} />}
              </LineChart>
            </ResponsiveContainer>
          </div>
        </section>
      );
    }

    function Footer(){
      return (
        <footer className="mt-auto border-t">
          <div className="container mx-auto max-w-7xl px-4 py-4 text-xs text-gray-500 flex flex-col sm:flex-row gap-2 sm:items-center sm:justify-between">
            <div>© {new Date().getFullYear()} StudyMate Light – KHKT</div>
            <div className="space-x-2">
              <a className="hover:text-gray-700" href="#">ESP32/Arduino sẵn sàng tích hợp</a>
              <span>•</span>
              <a className="hover:text-gray-700" href="#">Lux 400–600 | Tư thế 35–60cm</a>
            </div>
          </div>
        </footer>
      );
    }

    // ---------- Mount ----------
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App/>);
  </script>
</body>
</html>
